{"4cYhBtzvcP": [{"output_type": "stream", "name": "stdout", "text": "Epoch [1/10], Step [100/938], Loss: 0.2732\nEpoch [1/10], Step [200/938], Loss: 0.2285\nEpoch [1/10], Step [300/938], Loss: 0.1136\nEpoch [1/10], Step [400/938], Loss: 0.0807\nEpoch [1/10], Step [500/938], Loss: 0.1685\nEpoch [1/10], Step [600/938], Loss: 0.0710\nEpoch [1/10], Step [700/938], Loss: 0.0436\nEpoch [1/10], Step [800/938], Loss: 0.0697\nEpoch [1/10], Step [900/938], Loss: 0.0759\nEpoch [2/10], Step [100/938], Loss: 0.1470\nEpoch [2/10], Step [200/938], Loss: 0.0187\nEpoch [2/10], Step [300/938], Loss: 0.0183\nEpoch [2/10], Step [400/938], Loss: 0.0672\nEpoch [2/10], Step [500/938], Loss: 0.1397\nEpoch [2/10], Step [600/938], Loss: 0.0194\nEpoch [2/10], Step [700/938], Loss: 0.1472\nEpoch [2/10], Step [800/938], Loss: 0.1354\nEpoch [2/10], Step [900/938], Loss: 0.0642\nEpoch [3/10], Step [100/938], Loss: 0.1064\nEpoch [3/10], Step [200/938], Loss: 0.0153\nEpoch [3/10], Step [300/938], Loss: 0.0764\nEpoch [3/10], Step [400/938], Loss: 0.0241\nEpoch [3/10], Step [500/938], Loss: 0.0213\nEpoch [3/10], Step [600/938], Loss: 0.0042\nEpoch [3/10], Step [700/938], Loss: 0.0321\nEpoch [3/10], Step [800/938], Loss: 0.0229\nEpoch [3/10], Step [900/938], Loss: 0.0126\nEpoch [4/10], Step [100/938], Loss: 0.0016\nEpoch [4/10], Step [200/938], Loss: 0.0021\nEpoch [4/10], Step [300/938], Loss: 0.0316\nEpoch [4/10], Step [400/938], Loss: 0.0064\nEpoch [4/10], Step [500/938], Loss: 0.0573\nEpoch [4/10], Step [600/938], Loss: 0.0429\nEpoch [4/10], Step [700/938], Loss: 0.0324\nEpoch [4/10], Step [800/938], Loss: 0.0043\nEpoch [4/10], Step [900/938], Loss: 0.0011\nEpoch [5/10], Step [100/938], Loss: 0.0007\nEpoch [5/10], Step [200/938], Loss: 0.0034\nEpoch [5/10], Step [300/938], Loss: 0.0155\nEpoch [5/10], Step [400/938], Loss: 0.0719\nEpoch [5/10], Step [500/938], Loss: 0.0010\nEpoch [5/10], Step [600/938], Loss: 0.0010\nEpoch [5/10], Step [700/938], Loss: 0.0025\nEpoch [5/10], Step [800/938], Loss: 0.0277\nEpoch [5/10], Step [900/938], Loss: 0.0334\nEpoch [6/10], Step [100/938], Loss: 0.0030\nEpoch [6/10], Step [200/938], Loss: 0.0070\nEpoch [6/10], Step [300/938], Loss: 0.0248\nEpoch [6/10], Step [400/938], Loss: 0.0003\nEpoch [6/10], Step [500/938], Loss: 0.0202\nEpoch [6/10], Step [600/938], Loss: 0.0058\nEpoch [6/10], Step [700/938], Loss: 0.0006\nEpoch [6/10], Step [800/938], Loss: 0.0238\nEpoch [6/10], Step [900/938], Loss: 0.0044\nEpoch [7/10], Step [100/938], Loss: 0.0005\nEpoch [7/10], Step [200/938], Loss: 0.0202\nEpoch [7/10], Step [300/938], Loss: 0.0518\nEpoch [7/10], Step [400/938], Loss: 0.0033\nEpoch [7/10], Step [500/938], Loss: 0.0130\nEpoch [7/10], Step [600/938], Loss: 0.0014\nEpoch [7/10], Step [700/938], Loss: 0.0026\nEpoch [7/10], Step [800/938], Loss: 0.0025\nEpoch [7/10], Step [900/938], Loss: 0.0936\nEpoch [8/10], Step [100/938], Loss: 0.0314\nEpoch [8/10], Step [200/938], Loss: 0.0045\nEpoch [8/10], Step [300/938], Loss: 0.0073\nEpoch [8/10], Step [400/938], Loss: 0.0023\nEpoch [8/10], Step [500/938], Loss: 0.0161\nEpoch [8/10], Step [600/938], Loss: 0.0500\nEpoch [8/10], Step [700/938], Loss: 0.0011\nEpoch [8/10], Step [800/938], Loss: 0.0681\nEpoch [8/10], Step [900/938], Loss: 0.0535\nEpoch [9/10], Step [100/938], Loss: 0.0001\nEpoch [9/10], Step [200/938], Loss: 0.0009\nEpoch [9/10], Step [300/938], Loss: 0.0159\nEpoch [9/10], Step [400/938], Loss: 0.0021\nEpoch [9/10], Step [500/938], Loss: 0.0089\nEpoch [9/10], Step [600/938], Loss: 0.0199\nEpoch [9/10], Step [700/938], Loss: 0.0006\nEpoch [9/10], Step [800/938], Loss: 0.0042\nEpoch [9/10], Step [900/938], Loss: 0.0001\nEpoch [10/10], Step [100/938], Loss: 0.0005\nEpoch [10/10], Step [200/938], Loss: 0.0004\nEpoch [10/10], Step [300/938], Loss: 0.0043\nEpoch [10/10], Step [400/938], Loss: 0.0015\nEpoch [10/10], Step [500/938], Loss: 0.0650\nEpoch [10/10], Step [600/938], Loss: 0.0001\nEpoch [10/10], Step [700/938], Loss: 0.0007\nEpoch [10/10], Step [800/938], Loss: 0.0001\nEpoch [10/10], Step [900/938], Loss: 0.0137\nTest Accuracy: 98.99%\n"}], "0KiVc3DKq9": [], "k5YWyyqgo7": [], "GLMDo7DbS2": [], "bKaOFAsJO1": [], "83f6l2Dw3G": [], "tQqyQelokQ": [{"output_type": "stream", "name": "stdout", "text": "Epoch 1/10, Loss VAE: 79.8107, Loss Critic: 159.1532, Acc: 0.1064\nEpoch 2/10, Loss VAE: 0.5407, Loss Critic: 156.4372, Acc: 0.1027\nEpoch 3/10, Loss VAE: 0.2328, Loss Critic: 156.4391, Acc: 0.1027\nEpoch 4/10, Loss VAE: 0.1497, Loss Critic: 156.4354, Acc: 0.1027\nEpoch 5/10, Loss VAE: 0.1110, Loss Critic: 156.4441, Acc: 0.1028\nEpoch 6/10, Loss VAE: 0.0991, Loss Critic: 156.4344, Acc: 0.1027\n\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)\nCell \u001b[0;32mIn[7], line 59\u001b[0m\n\u001b[1;32m     57\u001b[0m \u001b[38;5;66;03m# Detach the VAE output so that gradients do NOT flow into c_vae.\u001b[39;00m\n\u001b[1;32m     58\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m torch\u001b[38;5;241m.\u001b[39mno_grad():\n\u001b[0;32m---> 59\u001b[0m     output \u001b[38;5;241m=\u001b[39m c_vae(x)\n\u001b[1;32m     61\u001b[0m \u001b[38;5;66;03m# Compute the critic loss using the detached z_mean from c_vae.\u001b[39;00m\n\u001b[1;32m     62\u001b[0m loss_critic \u001b[38;5;241m=\u001b[39m loss_fn_critic(x, output[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mz_mean\u001b[39m\u001b[38;5;124m\"\u001b[39m], c, data, model)\n\nFile \u001b[0;32m~/anaconda3/lib/python3.12/site-packages/torch/nn/modules/module.py:1736\u001b[0m, in \u001b[0;36mModule._wrapped_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1734\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_compiled_call_impl(\u001b[38;5;241m*\u001b[39margs, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs)  \u001b[38;5;66;03m# type: ignore[misc]\u001b[39;00m\n\u001b[1;32m   1735\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m-> 1736\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_call_impl(\u001b[38;5;241m*\u001b[39margs, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs)\n\nFile \u001b[0;32m~/anaconda3/lib/python3.12/site-packages/torch/nn/modules/module.py:1747\u001b[0m, in \u001b[0;36mModule._call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1742\u001b[0m \u001b[38;5;66;03m# If we don't have any hooks, we want to skip the rest of the logic in\u001b[39;00m\n\u001b[1;32m   1743\u001b[0m \u001b[38;5;66;03m# this function, and just call forward.\u001b[39;00m\n\u001b[1;32m   1744\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m (\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_backward_hooks \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_backward_pre_hooks \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_forward_hooks \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_forward_pre_hooks\n\u001b[1;32m   1745\u001b[0m         \u001b[38;5;129;01mor\u001b[39;00m _global_backward_pre_hooks \u001b[38;5;129;01mor\u001b[39;00m _global_backward_hooks\n\u001b[1;32m   1746\u001b[0m         \u001b[38;5;129;01mor\u001b[39;00m _global_forward_hooks \u001b[38;5;129;01mor\u001b[39;00m _global_forward_pre_hooks):\n\u001b[0;32m-> 1747\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m forward_call(\u001b[38;5;241m*\u001b[39margs, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs)\n\u001b[1;32m   1749\u001b[0m result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[1;32m   1750\u001b[0m called_always_called_hooks \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mset\u001b[39m()\n\nCell \u001b[0;32mIn[4], line 61\u001b[0m, in \u001b[0;36mClusterVAE.forward\u001b[0;34m(self, x)\u001b[0m\n\u001b[1;32m     58\u001b[0m z_mean, z_logvar \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mencoder(x)\n\u001b[1;32m     59\u001b[0m z \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mreparameterize(z_mean, z_logvar)\n\u001b[1;32m     60\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m {\n\u001b[0;32m---> 61\u001b[0m     \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mrecon\u001b[39m\u001b[38;5;124m\"\u001b[39m: \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdecoder(z),\n\u001b[1;32m     62\u001b[0m     \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mz\u001b[39m\u001b[38;5;124m\"\u001b[39m: z,\n\u001b[1;32m     63\u001b[0m     \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mz_mean\u001b[39m\u001b[38;5;124m\"\u001b[39m: z_mean,\n\u001b[1;32m     64\u001b[0m     \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mz_logvar\u001b[39m\u001b[38;5;124m\"\u001b[39m: z_logvar,\n\u001b[1;32m     65\u001b[0m }\n\nFile \u001b[0;32m~/anaconda3/lib/python3.12/site-packages/torch/nn/modules/module.py:1736\u001b[0m, in \u001b[0;36mModule._wrapped_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1734\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_compiled_call_impl(\u001b[38;5;241m*\u001b[39margs, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs)  \u001b[38;5;66;03m# type: ignore[misc]\u001b[39;00m\n\u001b[1;32m   1735\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m-> 1736\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_call_impl(\u001b[38;5;241m*\u001b[39margs, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs)\n\nFile \u001b[0;32m~/anaconda3/lib/python3.12/site-packages/torch/nn/modules/module.py:1747\u001b[0m, in \u001b[0;36mModule._call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1742\u001b[0m \u001b[38;5;66;03m# If we don't have any hooks, we want to skip the rest of the logic in\u001b[39;00m\n\u001b[1;32m   1743\u001b[0m \u001b[38;5;66;03m# this function, and just call forward.\u001b[39;00m\n\u001b[1;32m   1744\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m (\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_backward_hooks \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_backward_pre_hooks \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_forward_hooks \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_forward_pre_hooks\n\u001b[1;32m   1745\u001b[0m         \u001b[38;5;129;01mor\u001b[39;00m _global_backward_pre_hooks \u001b[38;5;129;01mor\u001b[39;00m _global_backward_hooks\n\u001b[1;32m   1746\u001b[0m         \u001b[38;5;129;01mor\u001b[39;00m _global_forward_hooks \u001b[38;5;129;01mor\u001b[39;00m _global_forward_pre_hooks):\n\u001b[0;32m-> 1747\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m forward_call(\u001b[38;5;241m*\u001b[39margs, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs)\n\u001b[1;32m   1749\u001b[0m result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[1;32m   1750\u001b[0m called_always_called_hooks \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mset\u001b[39m()\n\nCell \u001b[0;32mIn[4], line 40\u001b[0m, in \u001b[0;36mDecoder.forward\u001b[0;34m(self, x)\u001b[0m\n\u001b[1;32m     39\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mforward\u001b[39m(\u001b[38;5;28mself\u001b[39m, x):\n\u001b[0;32m---> 40\u001b[0m     x \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mconv(x)\n\u001b[1;32m     41\u001b[0m     x \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mflatten(x)\n\u001b[1;32m     42\u001b[0m     x \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfc(x)\n\nFile \u001b[0;32m~/anaconda3/lib/python3.12/site-packages/torch/nn/modules/module.py:1736\u001b[0m, in \u001b[0;36mModule._wrapped_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1734\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_compiled_call_impl(\u001b[38;5;241m*\u001b[39margs, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs)  \u001b[38;5;66;03m# type: ignore[misc]\u001b[39;00m\n\u001b[1;32m   1735\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m-> 1736\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_call_impl(\u001b[38;5;241m*\u001b[39margs, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs)\n\nFile \u001b[0;32m~/anaconda3/lib/python3.12/site-packages/torch/nn/modules/module.py:1741\u001b[0m, in \u001b[0;36mModule._call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1740\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m_call_impl\u001b[39m(\u001b[38;5;28mself\u001b[39m, \u001b[38;5;241m*\u001b[39margs, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs):\n\u001b[0;32m-> 1741\u001b[0m     forward_call \u001b[38;5;241m=\u001b[39m (\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_slow_forward \u001b[38;5;28;01mif\u001b[39;00m torch\u001b[38;5;241m.\u001b[39m_C\u001b[38;5;241m.\u001b[39m_get_tracing_state() \u001b[38;5;28;01melse\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mforward)\n\u001b[1;32m   1742\u001b[0m     \u001b[38;5;66;03m# If we don't have any hooks, we want to skip the rest of the logic in\u001b[39;00m\n\u001b[1;32m   1743\u001b[0m     \u001b[38;5;66;03m# this function, and just call forward.\u001b[39;00m\n\u001b[1;32m   1744\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m (\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_backward_hooks \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_backward_pre_hooks \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_forward_hooks \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_forward_pre_hooks\n\u001b[1;32m   1745\u001b[0m             \u001b[38;5;129;01mor\u001b[39;00m _global_backward_pre_hooks \u001b[38;5;129;01mor\u001b[39;00m _global_backward_hooks\n\u001b[1;32m   1746\u001b[0m             \u001b[38;5;129;01mor\u001b[39;00m _global_forward_hooks \u001b[38;5;129;01mor\u001b[39;00m _global_forward_pre_hooks):\n\n\u001b[0;31mKeyboardInterrupt\u001b[0m: \n"}], "Pv1qVZYTpt": []}